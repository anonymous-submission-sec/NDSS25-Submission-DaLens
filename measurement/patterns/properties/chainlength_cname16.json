{
  "pattern": "CNAME Chain Length up to 16",
  "description": "Try to measure the length of the CNAME chain a resolver is willing to follow.",
  "nameservers": {
    "0": [
      {
        "zone": "$0",
        "records": [
          { "name": "q.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c1.enc(rr0-vp0).$1." },
          { "name": "c2.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c3.enc(rr0-vp0).$1." },
          { "name": "c4.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c5.enc(rr0-vp0).$1." },
          { "name": "c6.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c7.enc(rr0-vp0).$1." },
          { "name": "c8.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c9.enc(rr0-vp0).$1." },
          { "name": "c10.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c11.enc(rr0-vp0).$1." },
          { "name": "c12.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c13.enc(rr0-vp0).$1." },
          { "name": "c14.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c15.enc(rr0-vp0).$1." },
          { "name": "c16.enc(rr0-vp0)", "type": "A", "ttl": 0}
        ]
      }
    ],
    "1": [
      {
        "zone": "$1",
        "records": [
          { "name": "c1.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c2.enc(rr0-vp0).$0." },
          { "name": "c3.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c4.enc(rr0-vp0).$0." },
          { "name": "c5.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c6.enc(rr0-vp0).$0." },
          { "name": "c7.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c8.enc(rr0-vp0).$0." },
          { "name": "c9.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c10.enc(rr0-vp0).$0." },
          { "name": "c11.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c12.enc(rr0-vp0).$0." },
          { "name": "c13.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c14.enc(rr0-vp0).$0." },
          { "name": "c15.enc(rr0-vp0)", "type": "CNAME", "ttl": 0, "ans": "c16.enc(rr0-vp0).$0." }
        ]
      }
    ]
  },
  "queries": [
    { 
      "rr": "rr0",
      "vp": "vp0",
      "query": "q.enc(rr0-vp0).$0",
      "wait": 0,
      "repeat": 1,
      "timeout": 20,
      "expected_status": "NOERROR"
    }
  ]
}
